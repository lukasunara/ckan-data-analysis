<div class="card align-items-center justify-content-center bg-light rounded-3 m-1">
    <h2 class="class-title">
        Overall Rating
        <i id="overallTooltip" class="bi-patch-question" data-bs-toggle="tooltip" data-bs-html="true"
            title="<p class='text-start'>Overall rating is based on the total <b>percentage</b> of earned points.<br/>
                The percentage equals to <b>sum</b> of earned points for each group of criteria <b>divided</b>
                by max number of points (500).</p>"
        ></i>
    </h2>
    <div class="card-body d-flex flex-row">
        <div>
            <h4 class="text-center">
                <%= overallResults.grade %>
                <i id="ratingTooltip" class="bi-patch-question" data-bs-toggle="tooltip" data-bs-html="true"
                    title="<p class='text-start'>Ratings are earned by these intervals (p = percentage):<br/>
                           <br/><b>excellent</b> (p &ge; 90%)
                           <br/><b>very good</b> (75% &ge; p &lt; 90%)
                           <br/><b>good</b> (55% &ge; p &lt; 75%)
                           <br/><b>bad</b> (40% &ge; p &lt; 55%)
                           <br/><b>very bad</b> (p &lt; 40%)</p>"
                ></i>
            </h4>
            <ul class="list-group list-group-flush mt-3">
                <li class="list-group-item bg-light">
                    Percentage: <span class="fw-bold"><%= overallResults.percentage.toFixed(2) %>%</span>    
                </li>
                <li class="list-group-item bg-light">
                    Earned points: <span class="fw-bold"><%= overallResults.earned.toFixed(2) %></span>
                </li>
                <li class="list-group-item bg-light">
                    MAX points: <span class="fw-bold"><%= overallResults.max %></span>
                </li>
            </ul>
        </div>
        <div><canvas id="ratingsChart"></canvas></div>
    </div>
    <div class="card-footer d-flex flex-column justify-content-center align-items-center bg-light">
        <div id="urlForUpdate" class="d-none" data-test="<%= urlForUpdate %>"></div>
        <p>This analysis was last updated on <span class="fw-bold"><%= objectData.last_updated.toLocaleString() %></span></p>
        <button class="btn btn-secondary" id="updateBtn">
            <span id="spinner" class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
            Update now
        </button>
    </div>
</div>

<script type="module" src="/scripts/charts/rating.js"></script>
<script type="module" src="/scripts/analysis/updateAnalysis.js"></script>